scale_colour_discrete(labels=c("박대통령", "평균")) +
ggtitle("평균과 비교(박대통령)") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41,size=2, linetype='dashed',color="orange") +
annotate("text", x=3, y=9.38, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=90, size=10))
ggplot(da1, aes(x=Hour,y=mean)) +
geom_line(size=1,col="black") +
geom_line(data=da5, aes(x=Hour,y=mean), col = "royalblue",size=1) +
scale_colour_discrete(labels=c("문대통령~현재", "평균")) +
ggtitle("평균과 비교(문대통령~현재)") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=90, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time1, score1)
mod00 <- mod0 %>%
group_by(time1) %>%
summarise(mean = mean(score1))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time1 = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time1
mod0 <- data.frame(time1, score1)
mod00 <- mod0 %>%
group_by(time1) %>%
summarise(mean = mean(score1))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time1 = make_datetime(Year, Month))
head(mod)
score1 <- mod$score
time1 <- mod$time1
mod0 <- data.frame(time1, score1)
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- mod$score
time1 <- mod$time
mod0 <- data.frame(time1, score1)
head(mod)
score1 <- mod$score
time1 <- mod$time
mod0 <- data.frame(time1, score1)
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time1, score1)
mod00 <- mod0 %>%
group_by(time1) %>%
summarise(mean = mean(score1))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
head(mod00)
library(dplyr)
library(rvest)
library(stringr)
library(tm)
library(ggplot2)
library(KoNLP)
library(showtext)
library(RColorBrewer)
library(extrafont)
library(nycflights13)
library(tidyverse)
library(lubridate)
library(wordcloud2)
windowsFonts(goB= windowsFont("고도 B"))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
url_base <- 'https://movie.naver.com'
start_url <- '/movie/bi/mi/point.nhn?code=17421'
url <- paste0(url_base, start_url)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src') -> if_url
ifr_url <- paste0(url_base, if_url)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_total') %>%
html_nodes('em') -> ems
pages <- ems[2] %>% html_text()
pages <- gsub(",", "", pages)
total_page <- ceiling(as.numeric(pages)/10)
html2 %>%
html_node('div.paging') %>%
html_node('a') %>%
html_attr('href') -> tmp
page_url_base <- str_sub(tmp, 1, -2)
df_points <- data.frame(score=c(), review=c(), writer=c(), time=c())
for (i in 1:total_page) {
if (i %% 100 == 0)
print(i)
page_url <- paste0(url_base, page_url_base, i)
html <- read_html(page_url)
html %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> tmp
idx <- str_locate(tmp, "\r")
rev <- str_sub(tmp, 1, idx[1]-1)
#print(rev)
review <- c(review, rev)
tmp <- trim(str_sub(tmp, idx[1], -1))
idx <- str_locate(tmp, "\r")
writer <- c(writer, str_sub(tmp, 1, idx[1]-1))
tmp <- trim(str_sub(tmp, idx[1], -1))
idx <- str_locate(tmp, "\r")
time <- c(time, str_sub(tmp, 1, idx[1]-1))
}
points <- data.frame(score=score, review=review, writer=writer, time=time)
df_points <- rbind.data.frame(df_points, points)
}
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time1) %>%
summarise(mean = mean(score1))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
.
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
score <- sto$score
time <- mod$time
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score1 <- sto$score
time1 <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod <- dad %>%
select(Year, Month) %>%
mutate(time = make_datetime(Year, Month))
head(mod)
score <- sto$score
time <- mod$time
mod0 <- data.frame(time, score)
mod00 <- mod0 %>%
group_by(time) %>%
summarise(mean = mean(score))
head(mod00)
ggplot(data = mod00, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod12_14 <- dad %>%
filter(Year=="2012" | Year=="2013" | Year == "2014") %>%
select(Year, Month, score) %>%
mutate(time = make_datetime(Year, Month)) %>%
select(time, score)
m_mod12_14 <- mod12_14 %>%
group_by(time) %>%
summarise(mean = mean(score))
ggplot(data = m_mod12_14, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("12-14년도 기간동안 월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod12_14 <- dad %>%
filter(Year=="2012" | Year=="2013" | Year == "2014") %>%
select(Year, Month, score) %>%
mutate(time = make_datetime(Year, Month)) %>%
select(time, score)
m_mod12_14 <- mod12_14 %>%
group_by(time) %>%
summarise(mean = mean(score))
ggplot(data = m_mod12_14, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("12-14년도 기간동안 월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod12_14 <- dad %>%
filter(Year=="2012" | Year=="2013" | Year == "2014") %>%
select(Year, Month, score) %>%
mutate(time = make_datetime(Year, Month)) %>%
select(time, score)
m_mod12_14 <- mod12_14 %>%
group_by(time) %>%
summarise(mean = mean(score))
ggplot(data = m_mod12_14, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("12-14년도 기간동안 월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
mod13 <- dad %>%
filter(Year=="2013") %>%
select(Year, Month, score) %>%
mutate(time = make_datetime(Year, Month)) %>%
select(time, score)
m_mod13 <- mod13 %>%
group_by(time) %>%
summarise(mean = mean(score))
ggplot(data = m_mod13, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("13년도 기간동안 월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
geom_hline(yintercept = 9.41, size=2,linetype='dashed',color="orange") +
annotate("text", x=3, y=9.43, size=4, colour="red", label="평균 = 9.41") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
wd <- dad %>%
select(Week, score) %>%
group_by(Week) %>%
summarise(mean = mean(score))
wd$Week <- recode(wd$Week,"일","월","화","수","목","금","토")
order <- c(1:7)
options(digits = 2)
wdo <- data.frame(wd,order)
ggplot(data = wdo, aes(x=reorder(Week,order),y=mean,fill=Week)) + geom_bar(stat='identity') +
coord_cartesian(ylim=c(9,9.8)) +
scale_fill_discrete(limits=c("일","월","화","수","목","금","토")) +
geom_text(aes(label=round(mean,2)),col="black",vjust=-0.1,size=5) +
ggtitle("요일별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=17),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=18))
mod13 <- dad %>%
filter(Year=="2013") %>%
select(Year, Month, score) %>%
mutate(time = make_datetime(Year, Month)) %>%
select(time, score)
m_mod13 <- mod13 %>%
group_by(time) %>%
summarise(mean = mean(score))
ggplot(data = m_mod13, aes(x=time, y=mean)) + geom_line(size=0.5, col="red") +
ggtitle("13년도 기간동안 월별 평점 평균 변화") +
labs(x="시간대", y="평점") +
theme(plot.title=element_text(family="goB", face="bold",size=17, color='royalblue'),
axis.title=element_text(size=13),
axis.title.y=element_text(angle=0),
axis.text.x=element_text(angle=0, size=10))
